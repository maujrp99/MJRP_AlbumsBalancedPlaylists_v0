<!doctype html>
<html lang="pt-BR">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Curadoria Híbrida</title>

    <!-- Tailwind + Inter for consistent styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://rsms.me/inter/inter.css">

    <style>
        /* Basic app-wide styles (kept minimal) */
        html,body { height:100%; margin:0; background:#000; color:#E0E0E0; font-family: 'Inter', sans-serif; }
        .spinner { border: 4px solid rgba(255,255,255,0.2); border-left-color:#1DB954; border-radius:50%; width:40px; height:40px; animation:spin 1s linear infinite }
        @keyframes spin { to { transform:rotate(360deg) } }
    </style>
</head>

<body class="antialiased">
    <div id="app-container">
        <header class="p-4 shadow">
            <div class="container mx-auto max-w-7xl flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-spotify-green" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M9 19V6l12-3v13" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
                    <h1 class="text-xl font-bold">Curadoria Híbrida</h1>
                </div>
                <div class="flex items-center space-x-3">
                    <button id="loadDataBtn" class="bg-gray-700 text-white px-4 py-2 rounded-full">Carregar Dados</button>
                    <button id="generateQuickBtn" class="bg-spotify-green text-black px-4 py-2 rounded-full">Gerar Playlists</button>
                    <button id="toggleViewBtn" class="bg-gray-700 text-white px-4 py-2 rounded-full">Ver Playlists</button>
                    <button id="saveBtn" class="bg-spotify-green text-black px-4 py-2 rounded-full"><span id="save-text">Salvar</span></button>
                </div>
            </div>
        </header>

        <main id="main-content" class="container mx-auto max-w-7xl p-4">
            <div id="loading-spinner" class="flex flex-col items-center justify-center p-16">
                <div class="spinner"></div>
                <p class="mt-4 text-spotify-lightgray">Carregando dados do Firestore...</p>
            </div>

            <section id="albums-view" class="hidden">
                <h2 class="text-3xl font-bold text-white mb-6">Álbuns (Origem)</h2>
                <div id="albums-summary" class="bg-spotify-gray p-4 rounded-lg mb-6 shadow-md"></div>
                <div class="text-center my-6">
                    <button id="generateBtn" class="bg-spotify-green text-black px-8 py-3 rounded-full font-bold">Gerar Playlists (Algoritmo Híbrido)</button>
                </div>
                <div id="albums-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
            </section>

            <section id="playlists-view" class="hidden">
                <h2 class="text-3xl font-bold text-white mb-6">Playlists Geradas</h2>
                <div id="playlists-summary" class="bg-spotify-gray p-4 rounded-lg mb-6 shadow-md"></div>
                <div id="playlists-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
            </section>
        </main>
    </div>

    <div id="dataModal" class="modal hidden">
        <div class="modal-content rounded-lg shadow-xl">
            <div class="p-4 border-b border-gray-700 flex justify-between items-center">
                <h3 class="text-lg font-semibold text-white">Buscar Álbuns (Texto)</h3>
                <button id="closeModalBtn" class="text-gray-400 hover:text-white">✕</button>
            </div>
            <div class="modal-body p-4">
                <textarea id="jsonInput" class="w-full h-64 bg-gray-900 border border-gray-700 rounded-md p-3 text-sm font-mono text-white" placeholder="Artista - Álbum\nArtista - Álbum..."></textarea>
                <p id="jsonError" class="text-red-400 text-sm mt-2"></p>
            </div>
            <div class="p-4 border-t border-gray-700 bg-gray-800 rounded-b-lg flex justify-end space-x-3">
                <button id="cancelModalBtn" class="bg-gray-600 text-white px-4 py-2 rounded-full">Cancelar</button>
                <button id="processJsonBtn" class="bg-spotify-green text-black px-4 py-2 rounded-full">Buscar Metadados e Salvar</button>
            </div>
        </div>
    </div>

    <!-- Load SortableJS first (defer) -->
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js" defer></script>

    <!-- Load firebase-config (must define window.__firebase_config) -->
    <script src="./js/firebase-config.js"></script>

    <!-- App entry (ES module) -->
    <script type="module" src="./js/app.js"></script>

</body>
</html>